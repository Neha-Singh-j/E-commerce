<%- include('../partials/header') %>

<!-- Category Navigation -->
<div style="display: flex; overflow-x: auto; padding: 10px 1rem; gap: 12px; background: #f7f7f7;">
  <% const categories = ['Fertilizer', 'Tractor', 'Drone', 'Irrigation', 'Sensor', 'Seeds']; %>
  <% categories.forEach(cat => { %>
    <a href="/category/<%= cat %>" style="text-decoration: none; padding: 10px 15px; border-radius: 8px; background: <%= cat === categoryName ? '#007BFF' : '#e0e0e0' %>; color: <%= cat === categoryName ? 'white' : 'black' %>;">
      <%= cat %>
    </a>
  <% }) %>
</div>

<!-- Search Bar -->
<div style="padding: 1rem; width: 100vw; box-sizing: border-box;">
  <h1 style="color: blue;">Testing Render</h1>
  <input
    type="text"
    id="searchInput"
    onkeyup="filterProducts()"
    placeholder="Search for products..."
    style="
      width: 100%;
      padding: 1rem;
      font-size: 18px;
      border: 2px solid #ccc;
      border-radius: 8px;
      outline: none;
    "
  />
</div>



<h2 style="padding-left: 1rem;">Category: <%= categoryName %></h2>

<!-- Product Grid -->
<div class="product-grid" style="display: flex; flex-wrap: wrap; gap: 20px; padding: 1rem;">
  <% if (allProducts.length === 0) { %>
    <p>No products found in this category.</p>
  <% } else { %>
    <% allProducts.forEach(product => { %>
      <div class="product product-card" style="border: 1px solid #ccc; padding: 1rem; width: 30%;">
        <img src="<%= product.img %>" alt="<%= product.name %>" style="width: 100%; height: 200px; object-fit: cover;" />
        <h4><%= product.name %></h4>
        <p><%= product.desc %></p>
        <p>Price: â‚¹<%= product.price %></p>
        <p>Rating: <%= product.rating || 'Not rated' %></p>
        <a href="/products/<%= product._id %>" style="color: #007BFF;">View Details</a>
      </div>
    <% }) %>
  <% } %>
</div>

<!-- Search Function -->
<script>
  function filterProducts() {
    let input = document.getElementById("searchInput").value.toLowerCase();
    let products = document.getElementsByClassName("product");

    Array.from(products).forEach(function(product) {
      const text = product.textContent.toLowerCase();
      product.style.display = text.includes(input) ? "block" : "none";
    });
  }
</script>

<%- include('../partials/footer') %>
